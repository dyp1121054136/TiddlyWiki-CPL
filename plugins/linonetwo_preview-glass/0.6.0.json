{"author":"LinOnetwo","core-version":">=5.1.22","dependents":"$:/plugins/tobibeer/appear $:/plugins/ooktech/dynamic-tables $:/plugins/linonetwo/inverse-link-and-folder","description":"Glassify Modification to the tobibeer/preview plugin, add inverse links, and make it auto-close","documentation":"https://tobibeer.github.io/tw5-preview","list":"readme tree config motivation","plugin-priority":"1","plugin-type":"plugin","source":"https://github.com/tobibeer/tw5-preview","text":"{\"tiddlers\":{\"$:/plugins/linonetwo/preview-glass/config\":{\"title\":\"$:/plugins/linonetwo/preview-glass/config\",\"text\":\"\\\\define default()\\n<dt>$(defaults)$$(option)$</dt>\\n<dd>\\n//{{$:/plugins/linonetwo/preview-glass/lingo/$(option)$}}<$list\\nfilter=\\\"[[$(option)$]prefix[template]]\\\">\\n{{$(defaults)$$(option)$}}</$list>://<br>\\n<$edit-text tag=input tiddler=\\\"$(defaults)$$(option)$\\\"/>\\n</dd>\\n\\\\end\\n\\n<dl class=\\\"preview-defaults\\\">\\n<$vars defaults=\\\"$:/plugins/linonetwo/preview-glass/defaults/\\\">\\n<$list filter=\\\"[all[tiddlers+shadows]removeprefix<defaults>sort[title]]\\\" variable=\\\"option\\\">\\n<<default>>\\n</$list>\\n</$vars>\\n</dl>\\n<style>.preview-defaults input {width:90%;}</style>\\n\"},\"$:/plugins/linonetwo/preview-glass/lingo/keys\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/keys\",\"text\":\"modifier keys to trigger popup directly on-hover (ctrl, alt+shift, meta, etc...)\"},\"$:/plugins/linonetwo/preview-glass/defaults/keys\":{\"title\":\"$:/plugins/linonetwo/preview-glass/defaults/keys\",\"text\":\"CTRL\"},\"$:/plugins/linonetwo/preview-glass/lingo/delay\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/delay\",\"text\":\"delay popup for this many milliseconds\"},\"$:/plugins/linonetwo/preview-glass/defaults/delay\":{\"title\":\"$:/plugins/linonetwo/preview-glass/defaults/delay\",\"text\":\"150\"},\"$:/plugins/linonetwo/preview-glass/lingo/class\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/class\",\"text\":\"css classes applied to the popup\"},\"$:/plugins/linonetwo/preview-glass/defaults/class\":{\"title\":\"$:/plugins/linonetwo/preview-glass/defaults/class\",\"text\":\"hover-popup-preview-container\"},\"$:/plugins/linonetwo/preview-glass/lingo/not\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/not\",\"text\":\"no preview for links inside elements with these classes\"},\"$:/plugins/linonetwo/preview-glass/defaults/not\":{\"title\":\"$:/plugins/linonetwo/preview-glass/defaults/not\",\"text\":\"tc-drop-down tc-search-drop-down tc-sidebar-scrollable tc-topbar tc-tiddler-title\"},\"$:/plugins/linonetwo/preview-glass/lingo/exclude\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/exclude\",\"text\":\"no preview for links to tiddlers matching this filter\"},\"$:/plugins/linonetwo/preview-glass/defaults/exclude\":{\"title\":\"$:/plugins/linonetwo/preview-glass/defaults/exclude\",\"text\":\"[is[system]] [all[shadows]] [!has[text]]\"},\"$:/plugins/linonetwo/preview-glass/lingo/template\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/template\",\"text\":\"the preview template\"},\"$:/plugins/linonetwo/preview-glass/defaults/template\":{\"title\":\"$:/plugins/linonetwo/preview-glass/defaults/template\",\"text\":\"$:/plugins/linonetwo/preview-glass/template\"},\"$:/plugins/linonetwo/preview-glass/lingo/open\":{\"title\":\"$:/plugins/linonetwo/preview-glass/lingo/open\",\"text\":\"view at ''<<WIKI>>''\"},\"$:/plugins/linonetwo/preview-glass/keyboard.js\":{\"title\":\"$:/plugins/linonetwo/preview-glass/keyboard.js\",\"text\":\"!function(){\\\"use strict\\\";var n={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46};exports.parseKeyDescriptorTB=function(e){for(var t,l,y=e.toUpperCase().split(\\\"+\\\"),r={keyCode:null,shiftKey:!1,altKey:!1,ctrlKey:!1},K=0;K<y.length;K++)t=!1,\\\"!\\\"===(l=y[K]).substr(0,1)&&(t=!0,l=l.substr(1)),\\\"CTRL\\\"===l?r.ctrlKey=!t||null:\\\"SHIFT\\\"===l?r.shiftKey=!t||null:\\\"ALT\\\"===l?r.altKey=!t||null:\\\"META\\\"===l?r.metaKey=!t||null:r.keyCode=n[l]||l.charCodeAt(0);return r},exports.checkKeyDescriptorTB=function(e,t){var l=!!t.metaKey;return!(null!==t.keyCode&&e.keyCode!==t.keyCode||(null===t.shiftKey?e.shiftKey:e.shiftKey!==t.shiftKey)||(null===t.altKey?e.altKey:e.altKey!==t.altKey)||(null===t.ctrlKey?e.ctrlKey:e.ctrlKey!==t.ctrlKey)||(null===t.metaKey?e.metaKey:e.metaKey!==l))}}();\",\"type\":\"application/javascript\",\"module-type\":\"utils\",\"Fixes $\":\"/core/modules/utils/dom/keyboard.js by providing an alternative.\"},\"$:/plugins/linonetwo/preview-glass/link.js\":{\"title\":\"$:/plugins/linonetwo/preview-glass/link.js\",\"text\":\"!function(){var w,e=require(\\\"$:/core/modules/widgets/link.js\\\").link,t=e.prototype.render,p=e.prototype.handleClickEvent;e.prototype.render=function(){t.apply(this,arguments);var r=this,n=this.wiki,u=this.domNodes[0],e=n.getTiddler(r.to),l=\\\"$:/plugins/linonetwo/preview-glass/defaults/\\\",o=\\\"$:/temp/tobibeer/preview-\\\",s=$tw.utils.parseKeyDescriptorTB(n.getTextReference(l+\\\"keys\\\",\\\"\\\").toUpperCase()),a=n.getTextReference(l+\\\"delay\\\").toUpperCase(),d=function(e){var t=$tw.popup.popupInfo(e),p=t.popupLevel;return n.getTextReference(o+p)&&n.getTextReference(o+p+\\\"-tiddler\\\")===r.to?null:t},c=function(){var e,t=d(u);t&&(e=t.popupLevel,clearTimeout(r.previewTimeout),$tw.popup.cancel(e),n.setText(o+ ++e+\\\"-tiddler\\\",\\\"text\\\",null,r.to),-1===$tw.popup.findPopup(o+e))&&setTimeout(function(){$tw.popup.triggerPopup({domNode:u,title:o+e,wiki:n}),w=0},50)};null!==(a=a!==undefined?parseInt(a):null)&&isNaN(a)&&(a=0),e&&($tw.utils.addClass(u,\\\"tc-popup-handle\\\"),$tw.utils.addClass(u,\\\"tc-popup-absolute\\\"),[\\\"mouseover\\\",\\\"mouseout\\\"].forEach(function(i){u.addEventListener(i,function(e){var p,t,o=e||window.event;\\\"mouseover\\\"===i?(p=1,(t=n.getTextReference(l+\\\"not\\\",\\\"\\\"))&&$tw.utils.each(t.split(\\\" \\\"),function(e){for(var t=u;t&&p;){if($tw.utils.hasClass(t,e))return p=0,!1;t=t.parentNode}}),(p=p&&0<=((t=n.getTextReference(l+\\\"exclude\\\",\\\"\\\"))?n.filterTiddlers(t):[]).indexOf(r.to)?0:p)&&(o.keyCode||(o.keyCode=0),$tw.utils.checkKeyDescriptorTB(o,s)?w||(w=1,c()):null!==a&&(w=0,r.previewTimeout=setTimeout(c,a)))):(w=0,clearTimeout(r.previewTimeout),e.relatedTarget&&e.relatedTarget.classList.contains(\\\"tc-preview-tiddler\\\")||$tw.popup.cancel(Math.max(0,d(u).popupLevel)))})}))},e.prototype.handleClickEvent=function(){p.apply(this,arguments),clearTimeout(this.previewTimeout),$tw.popup.cancel(Math.max(0,$tw.popup.popupInfo(this.domNodes[0]).popupLevel))}}();\",\"type\":\"application/javascript\",\"module-type\":\"startup\",\"created\":\"20200530032342272\",\"modified\":\"20200530033801090\"},\"$:/plugins/linonetwo/preview-glass/motivation\":{\"title\":\"$:/plugins/linonetwo/preview-glass/motivation\",\"created\":\"20200413015135813\",\"modified\":\"20200530032358118\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"[[Preview|http://tobibeer.github.io/tw5-plugins/#preview]] 鼠标悬浮链接查看预览，只展示内部链接，因为外部链接可能也是个 TiddlyWiki 而非常硕大。\\n\\n我在展示时使用了自己的模板，不展示具体内容，只展示 tag 和相关笔记，不然内容实在是太多了。真要看具体内容直接点击链接看不就好了。\\n\\n[[我还修改了原版的 JS|https://github.com/tobibeer/tw5-preview/issues/1]] ，从而让预览窗口在鼠标移开链接后就自动关闭，以免影响操作。\\n\\n```js\\n            // Mouseout\\n          } else {\\n            // No more blocking of mouseover events\\n            block = 0;\\n            // No more waiting for the popup\\n\\t\\t\\t\\t\\t\\tconst popupID = Math.max(0, getInfo(el).popupLevel);\\n            clearTimeout(self.previewTimeout);\\n            // close popup\\n            $tw.popup.cancel(popupID);\\n          }\\n```\\n\"},\"$:/plugins/linonetwo/preview-glass/popups\":{\"title\":\"$:/plugins/linonetwo/preview-glass/popups\",\"tags\":\"$:/tags/PageTemplate\",\"text\":\"\\\\define state(num)\\n$:/temp/tobibeer/preview-$num$\\n\\\\end\\n\\n\\\\define classes(num)\\ntc-popup appear appear-block appear-reveal tc-preview-tiddler tc-preview-tiddler-$num$ $(default-classes)$\\n\\\\end\\n\\n\\\\define level(num)\\n<$reveal tag=\\\"div\\\" type=\\\"popup\\\" state=<<state $num$>> class=<<classes $num$>>>\\n<$tiddler tiddler={{$:/temp/tobibeer/preview-$num$-tiddler}}>\\n<$transclude tiddler={{$:/plugins/linonetwo/preview-glass/defaults/template}} mode=\\\"block\\\"/>\\n</$tiddler>\\n</$reveal>\\n\\\\end\\n\\n<$vars default-classes={{$:/plugins/linonetwo/preview-glass/defaults/class}}>\\n<$list filter=\\\"1 2 3 4 5 6 7 8 9\\\">\\n<$macrocall $name=\\\"level\\\" num={{!!title}}/>\\n</$list>\\n</$vars>\\n\"},\"$:/plugins/linonetwo/preview-glass/preview-template.css\":{\"title\":\"$:/plugins/linonetwo/preview-glass/preview-template.css\",\"text\":\".hover-popup-preview-container{backdrop-filter:blur(10px);background:rgba(255,255,255,.3)!important;transform:translateY(0)}\",\"created\":\"20200415090452849\",\"modified\":\"20200530033507747\",\"tags\":\"$:/tags/Stylesheet\",\"type\":\"text/css\"},\"$:/plugins/linonetwo/preview-glass/readme\":{\"title\":\"$:/plugins/linonetwo/preview-glass/readme\",\"created\":\"20200414135748497\",\"modified\":\"20200602062349232\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"!! About\\n\\nModification to the [[tobibeer/preview plugin|https://tobibeer.github.io/tw5-plugins/#preview]], make it auto close if mouse move out of the link (as discussed in the [[issue#1|https://github.com/tobibeer/tw5-preview/issues/1]]), and add custom style, make it like a glass.\\n\\n!! Prerequisit\\n\\nThis plugin has three dependencies:\\n\\n# [[tobibeer/appear|http://tobibeer.github.io/tw5-plugins/#appear]] to make popup work\\n# [[$:/plugins/ooktech/dynamic-tables]] to make fields table in the popup template\\n# [[$:/plugins/linonetwo/inverse-link-and-folder]] to make bi-directional links in the popup template\\n\\n!! This Plugin is a Forked version\\n\\nOriginal source is located in [[https://github.com/tobibeer/tw5-preview]], which has version 0.5.6 at several years ago, so maybe this plugin can be 0.5.7?\\n\\nSee [[document of tobibeer/preview|https://tobibeer.github.io/tw5-plugins/#preview]] to get more usage and explaination.\\n\\nThis plugin provides some new template, which depends on some other plugin to work, see plugin.info for detail.\\n\\n- [[$:/plugins/linonetwo/preview-glass/preview-template.css]] new styles\\n- [[$:/plugins/linonetwo/preview-glass/template]] new template\\n\\nAnd some overrides:\\n\\n- [[$:/plugins/tobibeer/preview/link.js]] is override by this plugin, by providing a new js with same title\\n- [[$:/plugins/tobibeer/preview/defaults/not]] set some link to not have pop up.\\n- [[$:/plugins/tobibeer/preview/defaults/class]] and [[$:/plugins/tobibeer/preview/defaults/template]] override the template and style settings\\n- [[$:/plugins/tobibeer/preview/defaults/delay]] change the popup delay\\n\"},\"$:/plugins/linonetwo/preview-glass/template\":{\"title\":\"$:/plugins/linonetwo/preview-glass/template\",\"created\":\"20200413014112868\",\"modified\":\"20200415101145651\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"{{||$:/plugins/linonetwo/inverse-link-and-folder/infobar}}\\n\\n<<ColumnTable \\\"[<currentTiddler>]\\\" \\\"modified created\\\">>\"},\"$:/plugins/linonetwo/preview-glass/tree\":{\"title\":\"$:/plugins/linonetwo/preview-glass/tree\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<<tree prefix:\\\"$:/plugins/linonetwo/preview-glass/\\\">>\"}}}","title":"$:/plugins/linonetwo/preview-glass","type":"application/json","version":"0.6.0","Modern.TiddlyDev#SHA256-Hashed":"f86f59cb754732517fd8c5a53694afcd797bbdfd311a998b9d924c2d18159913","name":"preview-glass"}