{"title":"$:/plugins/xp/aggregation-snippets","name":"SNIPPETS","description":"Manage your snippets","version":"0.5.2","plugin-type":"plugin","parent-plugin":"$:/plugins/xp/aggregation","dependents":"$:/plugins/xp/aggregation","type":"application/json","author":"kl","text":"{\"tiddlers\":{\"$:/xp/ui/Actions/new-snippet\":{\"title\":\"$:/xp/ui/Actions/new-snippet\",\"description\":\"create a snippet\",\"tags\":\"$:/tags/Actions\",\"text\":\"\\\\define get-tags() $(textFieldTags)$\\n\\\\define get-text() $(textField)$\\n<$vars textFieldTags={{$:/config/new-snippet/Tags}} textField={{$:/config/new-snippet/Text}}>\\n<$action-sendmessage\\n\\t$message=\\\"tm-new-tiddler\\\"\\n\\ttitle=<<now \\\"snippet/YYYY0MM0DD0hh0mm0ssXXX\\\">>\\n\\ttags=<<get-tags>>\\n\\ttext=<<get-text>>\\n\\tcaption=\\\"snippets\\\"\\n/>\\n</$vars>\\n\"},\"$:/xp/ui/Buttons/new-snippet\":{\"title\":\"$:/xp/ui/Buttons/new-snippet\",\"caption\":\"{{$:/core/images/new-button}} new snippet\",\"description\":\"Create a snippet\",\"text\":\"\\\\whitespace trim\\n\\\\define newsnippetButton()\\n<$button actions={{$:/xp/ui/Actions/new-snippet}} tooltip=\\\"Create a snippet\\\" aria-label=\\\"new snippet\\\" class=<<tv-config-toolbar-class>>>\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/core/images/new-button}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\"><$text text=\\\"new snippet\\\"/></span>\\n</$list>\\n</$button>\\n\\\\end\\n<<newsnippetButton>>\\n\"},\"SNIPPETS\":{\"title\":\"SNIPPETS\",\"caption\":\"{{$:/xp/images/wikitext}} SNIPPETS\",\"color\":\"#bbb\",\"icon\":\"$:/xp/images/wikitext\",\"tmap.id\":\"814ad6af-a396-4dba-9da4-27d8eead4a7f\",\"text\":\"\\\\import $:/aggregation/macros/general $:/snippets-macros\\n\\\\whitespace trim\\n\\n\\\\define storeTitle() $:/temp/search/snippets\\n\\\\define filterState() $:/state/filter/aggregation-snippets\\n\\\\function configTiddler() $:/config/xp/aggregation-snippets/SearchScope\\n\\\\define templateTiddler() $:/config/xp/aggregation-snippets/TiddlerTemplate\\n\\\\define readingMode() $:/config/xp/aggregation-snippets/ReadingMode\\n\\\\define tocState() $:/state/xp/aggregation-snippets/toc\\n\\\\define selectedTiddler() $:/temp/toc/selectedTiddler/aggregation-snippets\\n\\\\define SubStoryList() $:/temp/xp/aggregation-snippets/SubStoryList\\n\\\\define SubHistoryList() $:/temp/xp/aggregation-snippets/SubHistoryList\\n\\n\\\\define alltagsfilter()\\n<$let L=\\\"tag[\\\" R=\\\"]\\\" lb=\\\"[\\\" rb={{{ [<configTiddler>get[text]removeprefix<lb>] }}}>\\n<$set filter=\\\"[list<filterState>addprefix<L>addsuffix<R>]+[join[]addprefix<lb>addsuffix<rb>addsuffix<sortRun>]\\\" name=\\\"alltags\\\" select=0>\\n<$text text=<<alltags>>/>\\n</$set>\\n</$let>\\n\\\\end\\n\\n\\\\define cancel-search-actions() <$action-deletetiddler $filter=\\\"[<filterState>get[checktiddler]enlist-input[]]\\\"/><$action-deletetiddler $filter=\\\"[<storeTitle>] [<filterState>]\\\"/><$action-sendmessage $message=\\\"tm-focus-selector\\\" $param=\\\".xp-search-snippets input\\\"/>\\n\\n\\n\\\\define keepstate() $:/keepstate/xp/aggregation-snippets\\n\\\\define pageTiddler() $(keepstate)$/Pagination\\n\\\\define pageStateTiddler() $(keepstate)$/page-number\\n\\\\define entryPerPageStateTiddler() $(keepstate)$/entry-per-page\\n\\n\\\\define newSnippetButton()\\n<$button actions={{$:/xp/ui/Actions/new-snippet}} tooltip=\\\"Create a new snippet\\\" aria-label=\\\"new snippet\\\" class=\\\"tc-btn-invisible tc-btn-mini\\\">\\n<span class=\\\"tc-btn-icon\\\">{{$:/core/images/new-button}}</span> new snippet\\n</$button>\\n\\\\end\\n\\n\\\\define navigatorNewSnippet()\\n\\\\whitespace trim\\n<$let page-number={{{ [<pageStateTiddler>get[text]] ~1 }}} >\\n<$list filter=\\\"[<storeTitle>!has[text]] [<filterState>!has[list]] [<readingMode>!text[on]] [<page-number>compare:number:lt[2]] +[count[]match[4]]\\\" emptyMessage=<<newSnippetButton>>>\\n<$navigator story=<<SubStoryList>> history=<<SubHistoryList>>><<newSnippetButton>></$navigator>\\n</$list>\\n</$let>\\n\\\\end\\n\\n\\\\define show-pagination()\\n\\\\whitespace notrim\\n<!-- $:/plugins/kookma/shiraz/macros/dtables/table-dynamic -->\\n<$reveal default=<<pagination>> type=\\\"match\\\" text=\\\"yes\\\" tag=\\\"div\\\" class=\\\"shiraz-dtable-page-footer\\\">\\n<hr>\\n<<prev-button>>\\nDisplaying <$text text={{{[<low>add[1]]}}}/> through <$text text={{{ [<high>compare:number:lt<total-entries>then<high>else<total-entries>] }}}/> of <<total-entries>> Results | <<limit-entries 10>>\\n<<next-button>>\\n</$reveal>\\n\\\\end\\n\\n<div class=\\\"tc-sidebar-lists xp-float-right\\\">\\n<<navigatorNewSnippet>>&emsp;<<aggregationCount>>&emsp;<<help-button-to \\\"$:/snippets-help\\\">>\\n</div>\\n\\n<$list filter=\\\"[tag<aggregationTag>limit[1]]\\\" emptyMessage={{$:/snippets-prompt}} variable=\\\"ignore\\\">\\n\\n<!-- Search Box -->\\n<span class=\\\"xp-search xp-search-snippets\\\">\\nSearch &#32; <$macrocall $name=\\\"selectSearchScope\\\" actions=<<snippets-select-actions>>/> <i class='tc-small-gap-left'/> <$macrocall\\n\\t$name=\\\"keyboard-driven-input\\\"\\n\\ttiddler=<<storeTitle>>\\n\\ttype=\\\"search\\\"\\n\\ttag=\\\"input\\\"\\n\\tfocus=\\\"true\\\"\\n\\tinputCancelActions=<<cancel-search-actions>>\\n/>\\n</span>\\n<i class='tc-tiny-gap-left'/>\\n<$let\\n\\tuserInput={{{ [<storeTitle>get[text]] }}}\\n\\tpagination={{{ [<pageTiddler>get[text]] }}}\\n\\tsortRun=\\\"+[!sort[created]]\\\"\\n\\tresultCount=\\\"<$count filter='[subfilter<searchFilter>!has[draft.of]]'/>\\\"\\n\\t>\\n<$wikify text=\\\"<$macrocall $name='alltagsfilter' filterState=<<filterState>>/>\\\" name=\\\"alltagsfilterwikified\\\">\\n<$set name=\\\"searchFilter\\\" filter=\\\"[<filterState>has[list]]\\\" value=<<alltagsfilterwikified>>\\n\\temptyValue={{{ [<configTiddler>get[text]addsuffix<sortRun>] }}}>\\n<span class=\\\"tc-search\\\">\\n<$list filter=<<filter-state-exists>> variable=\\\"ignore\\\">\\n<$button class=\\\"tc-btn-invisible\\\">\\n<<cancel-search-actions>>\\n{{$:/core/images/close-button}}\\n</$button>\\n</$list>\\n<<pagination-button>>\\n<<aggrbtn-reading-mode>>\\n<$macrocall $name=\\\"aggrbtn-toc\\\" filter=<<searchFilter>>/>\\n<$list filter=<<filter-state-exists>> variable=\\\"ignore\\\">\\n<span class=\\\"xp-search-results\\\"><<lingo System/Matches>></span>\\n</$list>\\n</span>\\n\\n<!-- Filter Panel -->\\n<$wikify text=<<listTagsInUse>> name=\\\"tagsInUse\\\">\\n<$list filter=\\\"[enlist<tagsInUse>limit[1]]\\\" variable=\\\"ignore\\\">\\n<div class=\\\"xp-wrapper-aggrfilter\\\">\\n<div class=\\\"xp-aggrfilter-category\\\" style=\\\"font-size:1em;padding:10px 0;\\\">\\n<span class=\\\"xp-aggrfilter-category-item\\\">\\n<$list filter=\\\"[enlist<tagsInUse>sort[]]\\\" variable=\\\"currentItem\\\">\\n<$macrocall $name=\\\"aggrfilteritem\\\" item=<<currentItem>>/>\\n</$list>\\n<<aggrbtn-deselect>>\\n</span>\\n</div>\\n</div>\\n</$list>\\n</$wikify>\\n\\n\\n<!-- Result List -->\\n<$reveal state=<<readingMode>> type=\\\"nomatch\\\" text=\\\"on\\\">\\n\\n<$let\\n  listFilter=\\\"[subfilter<searchFilter>] -[subfilter<searchFilter>has[draft.of]get[draft.title]]\\\"\\n  total-entries={{{ [subfilter<listFilter>count[]] }}}\\n  page-number={{{ [<pageStateTiddler>get[text]] ~1 }}} \\n  entries-per-page={{{ [<entryPerPageStateTiddler>get[text]] ~10 }}}\\n  low={{{ [<page-number>subtract[1]multiply<entries-per-page>] }}}  \\n  high={{{ [<page-number>multiply<entries-per-page>] }}}\\n  >\\n<$set name=\\\"finalFilter\\\" filter=\\\"[<pagination>match[yes]]\\\" value=\\\"[subfilter<listFilter>first<high>] -[subfilter<listFilter>first<low>]\\\" emptyValue=<<listFilter>>>\\n\\n<$transclude\\n  $variable=\\\"substory-navigator\\\"\\n  text=\\\"\\\"\\\"<p/>\\n<div class=\\\"tc-link-info\\\">\\n\\n<$list\\n  filter=<<finalFilter>>\\n  history=<<SubHistoryList>>\\n  template={{{ [<templateTiddler>has[text]get[text]] ~[[$:/templates/transclusion-snippet]] }}}\\n  editTemplate={{{ [[$:/config/xp/aggregation-snippets/EditTemplate]has[text]get[text]] ~[{$:/config/ui/EditTemplate}] }}}\\n  storyview={{$:/config/xp/aggregation-snippets/view}}\\n/>\\n\\n</div>\\n\\\"\\\"\\\"\\n  catchlink=yes\\n  filter=\\\"[tag<aggregationTag>]\\\"\\n/>\\n\\n<<show-pagination>>\\n\\n</$set>\\n</$let>\\n\\n</$reveal>\\n\\n<!-- Reading Mode -->\\n<$reveal state=<<readingMode>> type=\\\"match\\\" text=\\\"on\\\">\\n<$list filter=\\\"[subfilter<searchFilter>limit[1]]\\\" variable=\\\"ignore\\\">\\n\\n<$macrocall\\n\\t$name=\\\"aggregation-toc\\\"\\n\\tfilter=\\\"[subfilter<searchFilter>!has[draft.of]]\\\"\\n\\tselectedTiddler=<<selectedTiddler>>\\n\\texclude=<<aggregationTag>>\\n\\ttocState=<<tocState>>\\n\\tnavTiddler={{{ [<uiTitle>get[text]] }}}\\n/>\\n\\n</$list>\\n</$reveal>\\n\\n</$set></$wikify></$let>\\n\\n</$list>\\n\"},\"$:/config/xp/aggregation-snippets/EditTemplate\":{\"title\":\"$:/config/xp/aggregation-snippets/EditTemplate\",\"text\":\"$:/xp/aggregation/ui/EditTemplate\"},\"$:/config/xp/aggregation-snippets/ReadingMode\":{\"title\":\"$:/config/xp/aggregation-snippets/ReadingMode\",\"text\":\"off\"},\"$:/config/xp/aggregation-snippets/SearchScope\":{\"title\":\"$:/config/xp/aggregation-snippets/SearchScope\",\"text\":\"[tag<aggregationTag>sort[]search:*<userInput>]\"},\"$:/config/new-snippet/Tags\":{\"title\":\"$:/config/new-snippet/Tags\",\"text\":\"Snippet\"},\"$:/config/new-snippet/Text\":{\"title\":\"$:/config/new-snippet/Text\",\"text\":\"<<codes src:\\n\\\"\\\"\\\"\\n\\\"\\\"\\\">>\"},\"$:/config/xp/aggregation/ui/snippets\":{\"title\":\"$:/config/xp/aggregation/ui/snippets\",\"text\":\"SNIPPETS\"},\"$:/config/xp/aggregation-snippets/view\":{\"title\":\"$:/config/xp/aggregation-snippets/view\",\"text\":\"pop\"},\"$:/xp/images/wikitext\":{\"title\":\"$:/xp/images/wikitext\",\"tags\":\"$:/tags/Image\",\"text\":\"\\\\parameters (size:\\\"22pt\\\")\\n<svg width=<<size>> height=<<size>> viewBox=\\\"0 0 1024 1024\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M127.758244 383.101281h63.815421v-63.814398h-63.495126V64.024176H63.622528v255.262707h64.135716zM191.856098 64.024176h63.815421v255.262707h-63.815421zM319.769372 64.024176h63.815422v255.262707h-63.815422zM255.671519 319.286883h63.815421v63.814398h-63.815421zM448.996572 62.385862h63.816445v63.815422h-63.816445zM448.996572 191.655018h63.816445v191.446263h-63.816445zM640.435673 255.470439h63.814397v-63.815421h-63.814397V64.024176h-63.817468v319.077105h63.817468zM704.25007 255.470439h63.816445v63.816444h-63.816445zM768.066515 319.286883h63.814398v63.814398H768.066515zM768.066515 127.838573h63.815421V64.024176H768.066515v62.177108h-63.816445v63.816444h63.816445zM896.560004 64.024176h63.816445v63.814397h-63.816445zM896.560004 191.655018h63.816445v191.446263h-63.816445zM63.622528 961.614138h896.753921V447.367981H63.622528V961.614138z m512.997723-385.068076h319.077106v320.625368h-63.816444V704.419428H768.066515v63.572897h-63.814398v-63.814398h63.814398v-63.814397H576.620251v-63.817468z m-0.002046 256.809947h63.816444v-63.814398h63.814398v63.814398h-63.814398v63.814397h-63.816444v-63.814397z m-448.719768-256.809947h255.544117v63.816444H127.898437v-63.816444z m0 127.630842h255.54514v63.816445H127.898437v-63.816445z m0 129.178081h127.913275v63.816445h-127.913275v-63.816445z\\\"/></svg>\"},\"$:/snippets-help\":{\"title\":\"$:/snippets-help\",\"color\":\"#bbb\",\"icon\":\"$:/core/images/help\",\"text\":\"\\\\define hidePrefixText()\\n\\\\whitespace trim\\n<h2 class=\\\"tc-title\\\">\\n<$text text={{{ [<currentTiddler>removeprefix[snippet/]] }}}/>\\n</h2>\\n\\\\end\\n\\n<div class=\\\"blue-box\\\">\\n\\n''SNIPPETS 的用途：''记录自己常用的维基文本（WikiText）代码片段。\\n\\n</div>\\n\\n! 为什么要使用 SNIPPETS？\\n\\n默认的图章按钮无法管理大量的文本片段，所以 SNIPPETS 试图解决这个问题。SNIPPETS 将代码片段可视化，并通过搜索和标签过滤，进行快速查找。\\n\\n\\n! 如何使用？\\n\\n# 点击按钮 <span class=\\\"tc-btn-icon\\\">{{$:/core/images/new-button}}</span> new snippet 创建条目。<div class=\\\"gray-box\\\">\\n\\n使用 `codes` 宏生成一个带复制按钮的代码片段，可以高亮代码。比如：`<<codes js src:\\\"\\\"\\\"text\\\"\\\"\\\">>`。\\n\\n在阅读模式下可以查阅所有条目。\\n\\n</div>\\n\\n# 星标条目。<div class=\\\"gray-box\\\">\\n\\n常用的条目，可以打上标签 `Star`，卡片会有特殊标记。\\n\\n</div>\\n\\n# 参考其他帮助说明：[[Aggregation Readme|$:/plugins/xp/aggregation]] / [[Bookshelf Help|$:/bookshelf-help]]\\n\\n\\n! 设置\\n\\n预设为故事河中优先显示 Caption，见 $:/aggregation/ShowCaption。你可以通过下面按钮切换。\\n\\n<$vars configTiddler=\\\"$:/tags/ViewTemplateTitleFilter\\\" before-title=\\\"$:/config/ViewTemplateTitleFilters/default\\\">\\n\\n<$button>\\n<$list filter=\\\"[<configTiddler>!contains[$:/config/ViewTemplateTitleFilters/snippet]]\\\" variable=\\\"ignore\\\">\\nShow caption\\n<$action-listops $tiddler=<<configTiddler>> $subfilter=\\\"+[insertbefore:before-title[$:/config/ViewTemplateTitleFilters/snippet]]\\\"/>\\n</$list>\\n<$list filter=\\\"[<configTiddler>contains[$:/config/ViewTemplateTitleFilters/snippet]]\\\" variable=\\\"ignore\\\">\\nShow title\\n<$action-listops $tiddler=<<configTiddler>> $subfilter=\\\"-$:/config/ViewTemplateTitleFilters/snippet\\\"/>\\n</$list>\\n</$button>\\n\\n</$vars>\"},\"$:/snippets-macros\":{\"title\":\"$:/snippets-macros\",\"tags\":\"$:/tags/Macro/Aggregation\",\"text\":\"\\\\define aggregationTag() Snippet\\n\\\\define uiTitle()        $:/config/xp/aggregation/ui/snippets\\n\\n<pre><$view field=\\\"text\\\"/></pre>\"},\"$:/snippets-prompt\":{\"title\":\"$:/snippets-prompt\",\"text\":\"{{$:/aggregation/prompt}}\"},\"$:/xp/aggregation-snippets/styles\":{\"title\":\"$:/xp/aggregation-snippets/styles\",\"tags\":\"$:/tags/Stylesheet\",\"text\":\"[data-tiddler-title=\\\"SNIPPETS\\\"] {\\n\\tbackground: <<colour page-background>>;\\n\\tborder: 1px solid <<colour page-background>>;\\n\\t<<box-shadow \\\"none\\\">>\\n}\\n\\n[data-tiddler-title=\\\"SNIPPETS\\\"] .tc-titlebar {\\n\\tbackground: <<colour page-background>>;\\n}\\n\"},\"$:/config/ViewTemplateTitleFilters/snippet\":{\"title\":\"$:/config/ViewTemplateTitleFilters/snippet\",\"tags\":\"$:/tags/ViewTemplateTitleFilter\",\"text\":\"[prefix[snippet/]then[$:/xp/ui/ViewTemplate/title/caption]]\"},\"$:/templates/transclusion-snippet\":{\"title\":\"$:/templates/transclusion-snippet\",\"text\":\"\\\\whitespace trim\\n<div class={{{ [all[current]tag[Star]then[xp-aggregation-card-star]] ~[[xp-aggregation-card]] }}} style=\\\"font-size:0.8em;line-height:1.2;\\\">\\n\\n<h2><$link>\\n<$let tv-wikilinks=\\\"no\\\">\\n<$transclude field=\\\"caption\\\"><$view field=\\\"title\\\"/></$transclude>\\n</$let>\\n</$link><i class=\\\"tc-small-gap\\\"/><span class=\\\"tc-tiddler-controls xp-aggregation-controls\\\">{{||$:/core/ui/Buttons/clone}}\\n{{||$:/core/ui/Buttons/delete}}\\n{{||$:/core/ui/Buttons/edit}}\\n<$list filter=\\\"[all[current]!tag<aggregationTag>]\\\">{{||$:/core/ui/Buttons/close}}</$list></span></h2>\\n\\n<div class=\\\"tc-tags-wrapper\\\" style=\\\"font-size:0.85em;\\\"><$list filter=\\\"[all[current]tags[]sort[]] -[<aggregationTag>]\\\" template=\\\"$:/core/ui/TagTemplate\\\" storyview=\\\"pop\\\"/></div>\\n\\n<$transclude mode=\\\"block\\\"><p>Missing tiddler.</p></$transclude>\\n\\n</div>\\n\"}}}","revision":"0","bag":"default"}