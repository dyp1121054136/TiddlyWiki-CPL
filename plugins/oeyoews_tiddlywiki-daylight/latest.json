{"title":"$:/plugins/oeyoews/tiddlywiki-daylight","description":"Tiddlywiki Daylight","author":"oeyoews","version":"0.0.3","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"Tiddlywiki Daylight","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus $:/plugins/oeyoews/neotw-swal2 $:/plugins/oeyoews/neotw-back-to-top","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/tiddlywiki-daylight/readme\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/readme\",\"text\":\"!! Tiddlywiki Daylight\\n\\n> 在tiddlywiki使用两套不同的palette,对于第三方插件来说绝对是一场噩梦, 因为要不断进行适配(这是不太可能的), 没有人知道用户的palette是什么样子的(tw用户可能喜欢更改palette), 最终的效果绝对是欠佳的\\n\\n> 本插件目前仅支持githubdark和notebook主题, 其他主题理论上也可以使用\\n\\n<!-- > 针对tailwindcss -->\\n\\n!! TODO\\n\\n* 添加切换动画\\n* 配置ui\\n\\n!! Example\\n\\n<$button message=\\\"om-toggle-theme\\\" class=\\\"bg-slate-100 font-extrabold text-black dark:text-white dark:bg-black p-2\\\">\\nToggle theme\\n<svg stroke=\\\"currentColor\\\" class=\\\"inline dark:hidden\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" viewBox=\\\"0 0 24 24\\\" height=\\\"1em\\\" width=\\\"1em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M14.768 3.96v.001l-.002-.005a9.08 9.08 0 0 0-.218-.779c-.13-.394.21-.8.602-.67.29.096.575.205.855.328l.01.005A10.002 10.002 0 0 1 12 22a10.002 10.002 0 0 1-9.162-5.985l-.004-.01a9.722 9.722 0 0 1-.329-.855c-.13-.392.277-.732.67-.602.257.084.517.157.78.218l.004.002A9 9 0 0 0 14.999 6a9.09 9.09 0 0 0-.231-2.04ZM16.5 6c0 5.799-4.701 10.5-10.5 10.5-.426 0-.847-.026-1.26-.075A8.5 8.5 0 1 0 16.425 4.74c.05.413.075.833.075 1.259Z\\\"></path></svg>\\n<svg stroke=\\\"currentColor\\\" class=\\\"hidden dark:inline\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" viewBox=\\\"0 0 24 24\\\" height=\\\"1em\\\" width=\\\"1em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M12 19a7 7 0 1 1 0-14 7 7 0 0 1 0 14Zm0-1.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 1 0 0 11Zm-5.657.157a.75.75 0 0 1 0 1.06l-1.768 1.768a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.767-1.768a.75.75 0 0 1 1.061 0ZM3.515 3.515a.75.75 0 0 1 1.06 0l1.768 1.768a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L3.515 4.575a.75.75 0 0 1 0-1.06ZM12 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 12 0ZM4 12a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 12Zm8 8a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 12 20Zm12-8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 24 12Zm-6.343 5.657a.75.75 0 0 1 1.06 0l1.768 1.768a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-1.768-1.767a.75.75 0 0 1 0-1.061Zm2.828-14.142a.75.75 0 0 1 0 1.06l-1.768 1.768a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l1.767-1.768a.75.75 0 0 1 1.061 0Z\\\"></path></svg>\\n</$button>\\n\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/body-transition\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/body-transition\",\"text\":\"<!-- tags: $:/tags/Stylesheet -->\\n\\n\\\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline\\n\\nhtml {\\n  transition: 0.8s ease-in-out;\\n  animation: expand 1s ease-in-out;\\n}\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/dark\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/dark\",\"text\":\"<svg stroke=\\\"currentColor\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" viewBox=\\\"0 0 24 24\\\" height=\\\"24\\\" width=\\\"24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path fill=\\\"none\\\" d=\\\"M0 0h24v24H0z\\\"></path><path d=\\\"M9.37 5.51A7.35 7.35 0 009.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27A7.014 7.014 0 0112 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z\\\"></path></svg>\\n\",\"type\":\"image/svg+xml\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/daylight-listener.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/daylight-listener.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-daylight/daylight-listener.js\\ntype: application/javascript\\nmodule-type: library\\n\\nDaylight Listener Module\\n\\\\*/\\n\\n// 01: system: Follow the operating system mode\\n// 02: light/dark: Follow user configuration updates, here it is $:config/theme-mode\\n\\n// If configuration is modified, a restart is needed for it to take effect because the configuration is read from a file, and tw won't automatically update. If using localstorage, it can update the configuration automatically.\\nlocalStorage.theme =\\n  $tw.wiki.getTiddlerText('$:/config/theme-mode') || 'system';\\nconst currentMode = localStorage.theme;\\n\\n// Pay attention to whether the operating system supports switching between dark and light modes; in theory, it's supported everywhere (except for some Linux distributions and certain mobile platforms).\\n\\nlet isDarkMode = $tw.wiki.getTiddlerText('$:/info/darkmode') === 'yes'; // let isDarkMode = darkMode?.matches;\\n\\n// TODO: Configure UI\\n// check palette if exist\\n// preset: Default light and dark palettes\\nconst lightPalette = '$:/themes/nico/notebook/palettes/palette-beige';\\nconst darkPalette = '$:/palettes/GithubDark';\\n\\nfunction preset(event) {\\n  const systemMode = (event?.matches && 'dark') || 'light';\\n  const mode = currentMode === 'system' ? systemMode : currentMode;\\n  updateMode(mode);\\n}\\n\\nfunction updateMode(mode) {\\n  document.documentElement.className = mode;\\n  // Palette\\n  const palette = mode === 'dark' ? darkPalette : lightPalette;\\n  $tw.wiki.setText('$:/palette', 'text', null, palette);\\n  // Update mode\\n  localStorage.theme = mode;\\n}\\n\\n// Manually toggle light/dark\\nfunction toggleMode() {\\n  const NProgress = require('nprogress.min.js'); // This step may cause an error due to plugin loading order; NProgress might not be loaded yet, so manual loading is needed.\\n  NProgress?.start();\\n  // Need to get the current tiddlywiki mode\\n  const nextMode = isDarkMode ? 'light' : 'dark';\\n  // Update mode\\n  isDarkMode = !isDarkMode;\\n  updateMode(nextMode);\\n  NProgress?.done();\\n}\\n\\n// Listener\\nfunction checkModeListener() {\\n  const darkMode = window.matchMedia?.('(prefers-color-scheme: dark)');\\n  preset(darkMode); // NOTE: this will change your palette\\n  // Pay attention to whether the browser supports window.matchMedia\\n  darkMode?.addEventListener?.('change', (event) => {\\n    const systemMode = (event?.matches && 'dark') || 'light';\\n    // Update mode\\n    if (!systemMode === 'dark') isDarkMode = false;\\n    // Only listen to system mode\\n    if (currentMode === 'system') {\\n      updateMode(systemMode);\\n    }\\n  });\\n}\\n\\nmodule.exports = {\\n  checkModeListener,\\n  toggleMode,\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/icon\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/icon\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"icon icon-tabler icon-tabler-sun-moon\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" stroke-width=\\\"1\\\" stroke=\\\"currentColor\\\" fill=\\\"none\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\">\\n   <path stroke=\\\"none\\\" d=\\\"M0 0h24v24H0z\\\" fill=\\\"none\\\"></path>\\n   <path d=\\\"M9.173 14.83a4 4 0 1 1 5.657 -5.657\\\"></path>\\n   <path d=\\\"M11.294 12.707l.174 .247a7.5 7.5 0 0 0 8.845 2.492a9 9 0 0 1 -14.671 2.914\\\"></path>\\n   <path d=\\\"M3 12h1\\\"></path>\\n   <path d=\\\"M12 3v1\\\"></path>\\n   <path d=\\\"M5.6 5.6l.7 .7\\\"></path>\\n   <path d=\\\"M3 21l18 -18\\\"></path>\\n</svg>\",\"type\":\"image/svg+xml\"},\"$:/core/ui/ViewTemplate/body\":{\"title\":\"$:/core/ui/ViewTemplate/body\",\"tags\":\"$:/tags/ViewTemplate\",\"text\":\"\\\\import [all[shadows+tiddlers]tag[$:/tags/Macro/View/Body]!has[draft.of]]\\n\\n<$list filter=\\\"[all[current]is[system]]\\\">\\n<$reveal tag=\\\"div\\\" class=\\\"tc-tiddler-body\\\" type=\\\"nomatch\\\" stateTitle=<<folded-state>> text=\\\"hide\\\" retain=\\\"yes\\\" animate=\\\"yes\\\">\\n\\n<$transclude tiddler={{{ [<currentTiddler>] :cascade[all[shadows+tiddlers]tag[$:/tags/ViewTemplateBodyFilter]!is[draft]get[text]] :and[!is[blank]else[$:/core/ui/ViewTemplate/body/default]] }}} />\\n\\n</$reveal>\\n</$list>\\n\\n<!-- prose-invert -->\\n<!-- prose-li:marker:text-indigo-500  -->\\n<$list filter=\\\"[all[current]!is[system]]\\\">\\n<$reveal tag=\\\"div\\\" class=\\\"prose prose-indigo max-w-none prose-img:my-0 prose-a:no-underline prose-h2:mt-4 prose-blockquote:not-italic dark:prose-invert prose-img:rounded-md dark:prose-pre:bg-transparent\\\" type=\\\"nomatch\\\" stateTitle=<<folded-state>> text=\\\"hide\\\" retain=\\\"yes\\\" animate=\\\"yes\\\">\\n\\n<$transclude tiddler={{{ [<currentTiddler>] :cascade[all[shadows+tiddlers]tag[$:/tags/ViewTemplateBodyFilter]!is[draft]get[text]] :and[!is[blank]else[$:/core/ui/ViewTemplate/body/default]] }}} />\\n\\n</$reveal>\\n</$list>\\n\"},\"$:/core/ui/EditTemplate/title\":{\"title\":\"$:/core/ui/EditTemplate/title\",\"tags\":\"$:/tags/EditTemplate\",\"text\":\"\\\\whitespace trim\\n<$edit-text field=\\\"draft.title\\\" class=\\\"tc-titlebar tc-edit-texteditor bg-transparent focus:bg-[#F7F7F7] shadow-none placeholder:text-zinc-400 dark:bg-transparent caret-indigo-400\\\" focus=\\\"true\\\" tabindex={{$:/config/EditTabIndex}} placeholder=\\\"Title\\\"/>\\n\\n<$reveal state=\\\"!!draft.title\\\" type=\\\"nomatch\\\" text={{!!draft.of}} tag=\\\"div\\\">\\n\\n<$vars pattern=\\\"\\\"\\\"[\\\\|\\\\[\\\\]{}]\\\"\\\"\\\" bad-chars=\\\"\\\"\\\"`| [ ] { }`\\\"\\\"\\\">\\n\\n<$list filter=\\\"[all[current]regexp:draft.title<pattern>]\\\" variable=\\\"listItem\\\">\\n\\n<div class=\\\"tc-message-box\\\">\\n\\n{{$:/core/images/warning}}&#32;{{$:/language/EditTemplate/Title/BadCharacterWarning}}\\n\\n</div>\\n\\n</$list>\\n\\n</$vars>\\n\\n<$list filter=\\\"[{!!draft.title}!is[missing]]\\\" variable=\\\"listItem\\\">\\n\\n<div class=\\\"tc-message-box\\\">\\n\\n{{$:/core/images/warning}}&#32;{{$:/language/EditTemplate/Title/Exists/Prompt}}\\n\\n</div>\\n\\n</$list>\\n\\n<$list filter=\\\"[{!!draft.of}!is[missing]]\\\" variable=\\\"listItem\\\">\\n\\n<$vars fromTitle={{!!draft.of}} toTitle={{!!draft.title}}>\\n\\n<$checkbox tiddler=\\\"$:/config/RelinkOnRename\\\" field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\">&#32;{{$:/language/EditTemplate/Title/Relink/Prompt}}</$checkbox>\\n\\n<$tiddler tiddler=<<fromTitle>> >\\n\\n<$list filter=\\\"[relink:wouldchange<toTitle>limit[1]]\\\" variable=\\\"listItem\\\">\\n\\n<$vars stateTiddler=<<qualify \\\"$:/state/edit/references\\\">> >\\n\\n<$set\\n\\tname=\\\"prompt\\\"\\n\\tfilter=\\\"[relink:wouldchange<toTitle>relink:impossible<toTitle>]\\\"\\n\\tvalue=\\\"EditTemplate/Title/Impossibles/Prompt\\\"\\n\\temptyValue=\\\"EditTemplate/Title/References/Prompt\\\" >\\n<$reveal type=\\\"nomatch\\\" state=<<stateTiddler>> text=\\\"show\\\">\\n<$button set=<<stateTiddler>> setTo=\\\"show\\\" class=\\\"tc-btn-invisible\\\">\\n{{$:/core/images/right-arrow}}\\n&#32;\\n<$macrocall $name=lingo title=<<prompt>> />\\n</$button>\\n</$reveal>\\n<$reveal type=\\\"match\\\" state=<<stateTiddler>> text=\\\"show\\\">\\n<$button set=<<stateTiddler>> setTo=\\\"hide\\\" class=\\\"tc-btn-invisible\\\">\\n{{$:/core/images/down-arrow}}\\n&#32;\\n<$macrocall $name=lingo title=<<prompt>> />\\n</$button>\\n</$reveal>\\n</$set>\\n\\n<$reveal type=\\\"match\\\" state=<<stateTiddler>> text=\\\"show\\\">\\n<$list variable=\\\"listItem\\\" filter=\\\"[relink:wouldchange<toTitle>!title[$:/StoryList]sort[title]]\\\" template=\\\"$:/plugins/flibbles/relink/ui/ListItemTemplate\\\">\\n</$list>\\n</$reveal>\\n\\n</$vars>\\n\\n</$list>\\n\\n</$tiddler>\\n\\n</$vars>\\n\\n</$list>\\n\\n</$reveal>\\n\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/pagecontrol\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/pagecontrol\",\"list-before\":\"$:/core/ui/Buttons/more-page-actions\",\"description\":\"Toggle mode\",\"caption\":\"Toggle Mode\",\"tags\":\"$:/tags/PageControls\",\"text\":\"\\\\whitespace trim\\n<$button tooltip=\\\"Toggle Mode\\\" aria-label=\\\"\\\" class=<<tv-config-toolbar-class>> message=\\\"om-toggle-theme\\\">\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n<svg stroke=\\\"currentColor\\\" class=\\\"inline dark:hidden\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" viewBox=\\\"0 0 24 24\\\" height=\\\"1em\\\" width=\\\"1em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M14.768 3.96v.001l-.002-.005a9.08 9.08 0 0 0-.218-.779c-.13-.394.21-.8.602-.67.29.096.575.205.855.328l.01.005A10.002 10.002 0 0 1 12 22a10.002 10.002 0 0 1-9.162-5.985l-.004-.01a9.722 9.722 0 0 1-.329-.855c-.13-.392.277-.732.67-.602.257.084.517.157.78.218l.004.002A9 9 0 0 0 14.999 6a9.09 9.09 0 0 0-.231-2.04ZM16.5 6c0 5.799-4.701 10.5-10.5 10.5-.426 0-.847-.026-1.26-.075A8.5 8.5 0 1 0 16.425 4.74c.05.413.075.833.075 1.259Z\\\"></path></svg>\\n<svg stroke=\\\"currentColor\\\" class=\\\"hidden dark:inline\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" viewBox=\\\"0 0 24 24\\\" height=\\\"1em\\\" width=\\\"1em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M12 19a7 7 0 1 1 0-14 7 7 0 0 1 0 14Zm0-1.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 1 0 0 11Zm-5.657.157a.75.75 0 0 1 0 1.06l-1.768 1.768a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.767-1.768a.75.75 0 0 1 1.061 0ZM3.515 3.515a.75.75 0 0 1 1.06 0l1.768 1.768a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L3.515 4.575a.75.75 0 0 1 0-1.06ZM12 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 12 0ZM4 12a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 12Zm8 8a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 12 20Zm12-8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 24 12Zm-6.343 5.657a.75.75 0 0 1 1.06 0l1.768 1.768a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-1.768-1.767a.75.75 0 0 1 0-1.061Zm2.828-14.142a.75.75 0 0 1 0 1.06l-1.768 1.768a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l1.767-1.768a.75.75 0 0 1 1.061 0Z\\\"></path></svg>\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n<$text text=\\\"\\\"/>\\n</span>\\n</$list>\\n</$button>\\n\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/startup.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-daylight/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\ndaylight module\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  'use strict';\\n\\n  exports.name = 'daylight-startup-hook';\\n  exports.platforms = ['browser'];\\n  exports.after = ['startup'];\\n  exports.synchronous = true;\\n  exports.startup = () => {\\n    const { checkModeListener, toggleMode } = require('./daylight-listener');\\n    checkModeListener();\\n    $tw.rootWidget.addEventListener('om-toggle-theme', () => {\\n      toggleMode();\\n    });\\n  };\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/tiddlywiki-daylight/sun\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-daylight/sun\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"icon icon-tabler icon-tabler-sun-high\\\"  width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" stroke-width=\\\"1\\\" stroke=\\\"currentColor\\\" fill=\\\"none\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\">\\n   <path stroke=\\\"none\\\" d=\\\"M0 0h24v24H0z\\\" fill=\\\"none\\\"></path>\\n   <path d=\\\"M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z\\\"></path>\\n   <path d=\\\"M6.343 17.657l-1.414 1.414\\\"></path>\\n   <path d=\\\"M6.343 6.343l-1.414 -1.414\\\"></path>\\n   <path d=\\\"M17.657 6.343l1.414 -1.414\\\"></path>\\n   <path d=\\\"M17.657 17.657l1.414 1.414\\\"></path>\\n   <path d=\\\"M4 12h-2\\\"></path>\\n   <path d=\\\"M12 4v-2\\\"></path>\\n   <path d=\\\"M20 12h2\\\"></path>\\n   <path d=\\\"M12 20v2\\\"></path>\\n</svg>\\n\"}}}"}