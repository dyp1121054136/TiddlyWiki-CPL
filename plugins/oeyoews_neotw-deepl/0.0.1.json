{"title":"$:/plugins/oeyoews/neotw-deepl","description":"Neotw Deepl","author":"oeyoews","version":"0.0.1","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"Neotw Deepl","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-deepl/Action\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/Action\",\"tags\":\"$:/tags/StartupAction/PostRender\",\"text\":\"<$list filter=\\\"[{$:/info/url/search}match[?layout=neotw-deepl]]\\\">\\n  <$action-setfield $tiddler=\\\"$:/layout\\\" text=\\\"$:/plugins/oeyoews/neotw-deepl/Layout\\\"/>\\n</$list>\"},\"$:/plugins/oeyoews/neotw-deepl/Layout\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/Layout\",\"tags\":\"$:/tags/Layout\",\"name\":\"{{$:/plugins/oeyoews/neotw-deepl/icon}}\",\"description\":\"{{$:/plugins/oeyoews/neotw-deepl/readme!!description}}\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\\n\\n<$vars\\n\\ttv-config-toolbar-icons={{$:/config/Toolbar/Icons}}\\n\\ttv-config-toolbar-text={{$:/config/Toolbar/Text}}\\n\\ttv-config-toolbar-class={{$:/config/Toolbar/ButtonClass}}\\n\\ttv-enable-drag-and-drop={{$:/config/DragAndDrop/Enable}}\\n\\ttv-show-missing-links={{$:/config/MissingLinks}}\\n\\tstoryviewTitle={{$:/view}}\\n\\tlanguageTitle={{{ [{$:/language}get[name]] }}}>\\n\\n<div class=\\\"prose max-w-none prose-indigo m-auto sm:w-auto md:w-2/3\\\">\\n  {{{ [[$:/plugins/oeyoews/neotw-deepl/readme]] ||$:/core/ui/ViewTemplate }}}\\n</div>\"},\"$:/plugins/oeyoews/neotw-deepl/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/readme\",\"description\":\"Neotw Deepl\",\"text\":\"{{$:/languages/neotw-deepl/readme}}\\n\"},\"$:/plugins/oeyoews/neotw-deepl/view\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/view\",\"caption\":\"Deepl\",\"mask-closable\":\"yes\",\"subtitle\":\"{{$:/plugins/oeyoews/neotw-deepl/icon}} Deepl\",\"class\":\"o-tm\",\"text\":\"<h3 class=\\\"text-center m-0\\\">Deepl Translator</h3>\\n\\n<$deepl />\"},\"$:/plugins/oeyoews/neotw-deepl/deepl.js\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/deepl.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-deepl/deepl.js\\ntype: application/javascript\\nmodule-type: library\\n\\nneotw-deepl library\\n\\n\\\\*/\\nfunction deepl() {\\n  function debounce(func, wait) {\\n    let timeout;\\n    return function () {\\n      const context = this;\\n      const args = arguments;\\n      clearTimeout(timeout);\\n      timeout = setTimeout(function () {\\n        func.apply(context, args);\\n      }, wait);\\n    };\\n  }\\n\\n  // ÁøªËØëÂáΩÊï∞\\n  function translateText() {\\n    const inputText = document.getElementById('input').value;\\n    const outputText = document.getElementById('output');\\n    const languageSelect = document.getElementById('languageSelect');\\n    const targetLang = languageSelect.value;\\n\\n    const params = new URLSearchParams();\\n    let DEEPL_API_KEY = localStorage.getItem('DEEPL_API_KEY');\\n\\n    if (!DEEPL_API_KEY) {\\n      DEEPL_API_KEY = window.prompt('Please enter your API key:');\\n      localStorage.setItem('DEEPL_API_KEY', DEEPL_API_KEY);\\n    }\\n    const apiUrl = 'https://api-free.deepl.com/v2/translate';\\n\\n    params.append('auth_key', DEEPL_API_KEY);\\n    params.append('text', inputText);\\n    params.append('target_lang', targetLang);\\n\\n    fetch(apiUrl, {\\n      method: 'POST',\\n      body: params,\\n    })\\n      .then((response) => response.json())\\n      .then((data) => {\\n        if (!data.message) {\\n          outputText.value = data.translations[0].text;\\n        } else {\\n          // TODO\\n          // alert(data.message);\\n        }\\n      });\\n  }\\n\\n  const debouncedTranslate = debounce(translateText, 200);\\n\\n  // ÁõëÂê¨ËæìÂÖ•Ê°ÜÂíåËØ≠Ë®ÄÈÄâÊã©Ê°ÜÁöÑÂèòÂåñ\\n  document\\n    .getElementById('input')\\n    .addEventListener('input', debouncedTranslate);\\n\\n  document\\n    .getElementById('languageSelect')\\n    .addEventListener('change', debouncedTranslate);\\n\\n  // Â§çÂà∂ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂\\n  document.getElementById('copyButton').addEventListener('click', function () {\\n    const outputText = document.getElementById('output').value;\\n    navigator.clipboard\\n      .writeText(outputText)\\n      .then(() => {\\n        Swal.fire({\\n          toast: true,\\n          icon: 'success',\\n          position: 'top-end',\\n          timer: 1500,\\n          title: 'Â§çÂà∂ÊàêÂäü',\\n          showConfirmButton: false,\\n        });\\n      })\\n      .catch((error) => {\\n        console.error('Error:', error);\\n      });\\n  });\\n}\\n\\nmodule.exports = deepl;\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-deepl/EditorToolbar\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/EditorToolbar\",\"tags\":\"$:/tags/EditorToolbar\",\"caption\":\"Deepl\",\"condition\":\"[<targetTiddler>!has[type]] [<targetTiddler>type[text/vnd.tiddlywiki]] [<targetTiddler>type[text/markdown]]\",\"dropdown\":\"$:/plugins/oeyoews/neotw-deepl/view\",\"button-classes\":\"tc-text-editor-toolbar-item-start-group\",\"text\":\"<!-- icon: $:/plugins/oeyoews/neotw-emoji-picker/icon -->\\n\\nDeepl\\n\"},\"$:/plugins/oeyoews/neotw-deepl/icon\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/icon\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" height=\\\"24\\\"><path d=\\\"M12.375 2.102a.737.737 0 0 0-.75 0l-7.11 4.101a.76.76 0 0 0-.374.652v8.207c0 .266.144.516.375.649l10.664 6.187c.23.137.515.137.75 0a.748.748 0 0 0 .375-.648v-3.703l3.18-1.836a.748.748 0 0 0 .374-.649V6.855a.76.76 0 0 0-.375-.652ZM12 3.617l6.36 3.672v7.34l-3.18 1.836a.753.753 0 0 0-.375.648v2.836L5.64 14.63v-7.34Zm-1.344 9.031a1.49 1.49 0 0 0-2.23 1.293 1.488 1.488 0 0 0 2.976.008l.973-.554a.75.75 0 0 0-.75-1.3Zm0-3.09 2.7 1.555c.003.82.671 1.485 1.488 1.485a1.491 1.491 0 1 0-.738-2.785l-2.704-1.555a1.486 1.486 0 0 0-1.488-1.48 1.49 1.49 0 0 0-1.488 1.488 1.49 1.49 0 0 0 2.23 1.293Zm0 0\\\" style=\\\"stroke:none;fill-rule:evenodd;fill:#000;fill-opacity:1\\\"/></svg>\",\"type\":\"image/svg+xml\"},\"$:/languages/neotw-deepl/readme\":{\"title\":\"$:/languages/neotw-deepl/readme\",\"text\":\"<div class=\\\"prose max-w-none prose-indigo\\\">\\n\\n!! Deepl Translator\\n\\n<$deepl />\\n\\n!! DEEPL API\\n\\n* ÈúÄË¶Å‰ø°Áî®Âç°\\n* need creadit card\\n\\n</div>\"},\"$:/plugins/oeyoews/neotw-deepl/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-deepl/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-deepl/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-deepl widget\\n\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  'use strict';\\n\\n  const Widget = require('$:/core/modules/widgets/widget.js').widget;\\n\\n  class DeeplWidget extends Widget {\\n    constructor(parseTreeNode, options) {\\n      super(parseTreeNode, options);\\n    }\\n\\n    render(parent, nextSibling) {\\n      if (!$tw.browser) return;\\n\\n      const deepl = require('./deepl');\\n\\n      const textareaClass =\\n        'shadow border-0 resize-none h-48 w-full rounded p-2 focus:outline-none focus:ring-0 focus:ring-blue-500';\\n      const buttonClass = 'mt-2 p-2 text-white rounded w-auto';\\n      const selectClass =\\n        'mt-2 p-2 border rounded focus:outline-none border-none shadow focus:ring-2 focus:ring-blue-500 flex';\\n\\n      const leftOptionEN = $tw.utils.domMaker('option', {\\n        text: 'EN',\\n      });\\n\\n      const leftOptionCN = $tw.utils.domMaker('option', {\\n        text: 'ZH',\\n      });\\n\\n      const selectNode = $tw.utils.domMaker('select', {\\n        class: selectClass,\\n        children: [leftOptionEN, leftOptionCN],\\n        attributes: {\\n          id: 'languageSelect',\\n        },\\n      });\\n\\n      const copyButton = $tw.utils.domMaker('button', {\\n        text: 'üìã',\\n        class: buttonClass,\\n        attributes: {\\n          type: 'button',\\n          id: 'copyButton',\\n        },\\n      });\\n\\n      const textareaLeft = $tw.utils.domMaker('textarea', {\\n        class: textareaClass,\\n        attributes: {\\n          placeholder: 'ËæìÂÖ•ÈúÄË¶ÅÁøªËØëÁöÑËØ≠Ë®Ä',\\n          id: 'input',\\n        },\\n      });\\n\\n      const textareaRight = $tw.utils.domMaker('textarea', {\\n        class: textareaClass,\\n        attributes: {\\n          placeholder: 'ÁøªËØëÁöÑÂÜÖÂÆπ',\\n          readonly: '',\\n          id: 'output',\\n        },\\n      });\\n\\n      const deeplRightContainer = $tw.utils.domMaker('div', {\\n        children: [textareaRight, copyButton],\\n      });\\n\\n      const deeplLeftContainer = $tw.utils.domMaker('div', {\\n        children: [textareaLeft, selectNode],\\n      });\\n\\n      const deeplSecContainer = $tw.utils.domMaker('div', {\\n        class: 'grid grid-cols-2 gap-4',\\n        children: [deeplLeftContainer, deeplRightContainer],\\n      });\\n\\n      // TODO: ÁßªÈô§ÈáçÂ§çËäÇÁÇπ\\n      const deeplContainer = $tw.utils.domMaker('div', {\\n        class: 'container mx-auto p-4',\\n        children: [deeplSecContainer],\\n      });\\n\\n      parent.insertBefore(deeplContainer, nextSibling);\\n      this.domNodes.push(deeplContainer);\\n\\n      deepl();\\n    }\\n  }\\n\\n  exports['deepl'] = DeeplWidget;\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}