{"title":"$:/plugins/oeyoews/neotw-copy-code","description":"Neotw Copy Code","author":"oeyoews","version":"0.0.2","core-version":">=5.2.5","type":"application/json","plugin-type":"plugin","name":"Neotw Copy Code","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme explore","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-copy-code/Layout\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/Layout\",\"tags\":\"$:/tags/Layout\",\"name\":\"{{$:/plugins/oeyoews/neotw-copy-code/icon}} Neotw Copy Code\",\"description\":\"{{$:/plugins/oeyoews/neotw-copy-code/readme!!description}}\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\\n\\n<$vars\\n  tv-config-toolbar-icons={{$:/config/Toolbar/Icons}}\\n  tv-config-toolbar-text={{$:/config/Toolbar/Text}}\\n  tv-config-toolbar-class={{$:/config/Toolbar/ButtonClass}}\\n  tv-enable-drag-and-drop={{$:/config/DragAndDrop/Enable}}\\n  tv-show-missing-links={{$:/config/MissingLinks}}\\n  storyviewTitle={{$:/view}}\\n  languageTitle={{{ [{$:/language}get[name]] }}}>\\n\\n<div class=\\\"prose max-w-none prose-indigo m-auto sm:w-auto md:w-2/3\\\">\\n{{{ [[$:/plugins/oeyoews/neotw-copy-code/readme]] ||$:/core/ui/ViewTemplate }}}\\n</div>\"},\"$:/plugins/oeyoews/neotw-copy-code/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/readme\",\"description\":\"~Copy Code\",\"text\":\"<div class=\\\"prose max-w-none prose-indigo\\\">\\n\\n!! Neotw Copy Code\\n\\n* [[Source|https://github.com/oeyoews/neotw/tree/main/plugins/oeyoews/neotw-copy-code]]\\n* [[Demo|https://oeyoews.github.io/neotw]]\\n\\nThis plugin is designed to add a copy code button to code blocks in TiddlyWiki, making it easier to copy code snippets with their formatting and indentation intact. In TiddlyWiki, code blocks are typically wrapped in the `<pre>` tag to preserve their formatting and indentation. However, copying the code manually can be inconvenient.\\n\\n> 这个插件的设计初衷是为了在 TiddlyWiki 中的代码块中添加一个复制代码按钮，使得复制代码片段时能够保留其格式和缩进。在 TiddlyWiki 中，代码块通常会被包裹在 `<pre>` 标签中，以保留其格式和缩进。但是，手动复制代码时会比较麻烦。\\n\\nThis plugin solves this problem by adding a “Copy Code” button next to the code block. Clicking the button copies the code to the clipboard, and the copied code is also displayed in a popup using the SweetAlert2 plugin, making it easy to verify that the code was copied successfully.\\n> 这个插件通过在代码块旁边添加一个“复制代码”按钮来解决这个问题。点击按钮后，代码会被复制到剪贴板中，并且复制的代码也会使用 SweetAlert2 插件在弹出窗口中显示，方便验证代码是否复制成功。\\n\\nThis plugin can greatly improve the efficiency and convenience of displaying and sharing code in TiddlyWiki, especially when you need to copy code frequently.\\n> 这个插件可以极大地提高在 TiddlyWiki 中显示和分享代码的效率和便利性，尤其是在需要频繁复制代码时。\\n\\nThe only downside at the moment is that the copy button needs to be manually triggered for display.\\n> 目前唯一的缺点是复制按钮需要手动触发才会显示。\\n\\n!! Example\\n\\n<$button message=\\\"om-copy-code\\\" >\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}} Click to show copy code button\\n</$button>\\n\\n```python\\n# Hello World program in Python\\nprint(\\\"Hello, World!\\\")\\n```\\n\\n```java\\n// Hello World program in Java\\npublic class HelloWorld {\\n    public static void main(String[] args) {\\n        System.out.println(\\\"Hello, World!\\\");\\n    }\\n}\\n```\\n\\n```javascript\\n// Hello World program in JavaScript\\nconsole.log(\\\"Hello, World!\\\");\\n```\\n\\n```c\\n/* Hello World program in C */\\n#include <stdio.h>\\nint main() {\\n    printf(\\\"Hello, World!\\\");\\n    return 0;\\n}\\n```\\n\\n```cpp\\n// Hello World program in C++\\n#include <iostream>\\nint main() {\\n    std::cout << \\\"Hello, World!\\\";\\n    return 0;\\n}\\n```\\n\\n```ruby\\n# Hello World program in Ruby\\nputs \\\"Hello, World!\\\"\\n```\\n\\n```php\\n<?php\\n// Hello World program in PHP\\necho \\\"Hello, World!\\\";\\n?>\\n```\\n\\n```swift\\n// Hello World program in Swift\\nprint(\\\"Hello, World!\\\")\\n```\\n\\n```go\\n// Hello World program in Go\\npackage main\\nimport \\\"fmt\\\"\\nfunc main() {\\n    fmt.Println(\\\"Hello, World!\\\")\\n}\\n```\\n\\n```kotlin\\n// Hello World program in Kotlin\\nfun main() {\\n    println(\\\"Hello, World!\\\")\\n}\\n```\\n\\n!! TODO\\n\\n<!-- * update copied icon -->\\n<!-- * add viewtoolbar not pagecontrol -->\\n<!-- * support hover scroll for code preview -->\\n<!-- * update style for button -->\\n<!-- * add hover style -->\\n* make preview is optional\\n* add transform style\\n* update plugin dependencies\\n* float right modify too long code view when hover\\n\\n* copy code to image\\n* support copy image to clipboard\\n\\n!! Performace\\n\\n* lazy load button\\n\\n</div>\\n\"},\"$:/plugins/oeyoews/neotw-copy-code/add-copybutton.js\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/add-copybutton.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-copy-code/add-copybutton.js\\ntype: application/javascript\\nmodule-type: library\\n\\neotw-copy-code widget\\n\\n\\\\*/\\n\\n// 不适合\\n/* function copybuttonListener() {\\n  document.addEventListener('mouseenter', () => {\\n    const codeBlocks = document.querySelectorAll('pre');\\n    codeBlocks.forEach(codeBlock => {\\n      codeBlock.addEventListener('mouseenter', () => {\\n        addCopyButton();\\n      });\\n    });\\n  });\\n} */\\n\\nmodule.exports = function addCopyButton() {\\n  // 找到当前页面的所有代码块\\n  const codeBlocks = document.querySelectorAll('pre');\\n\\n  Swal.fire({\\n    title: codeBlocks.length ? `Enable copy code` : `当前页面没有发现代码块`,\\n    icon: codeBlocks.length ? 'success' : 'info',\\n    toast: true,\\n    showCancelButton: false,\\n    showConfirmButton: false,\\n    timer: 1500,\\n    position: 'top-end',\\n  });\\n\\n  // 如果没有代码块, 结束\\n  if (!codeBlocks.length) {\\n    return;\\n  }\\n\\n  codeBlocks.forEach((codeBlock) => {\\n    // codeBlock.addEventListener('mouseenter', () => {\\n    //   console.log('updated');\\n    // });\\n    // 查找 copybutton 按钮\\n    const existingButton = codeBlock.querySelector('.copy-button');\\n    // 如果已经添加过copybutton, 结束\\n    if (existingButton) return;\\n\\n    // TODO: not work\\n    // 如果代码为空, 不添加 copybutton 按钮\\n    const codeElement = codeBlock.querySelector('code');\\n    if (!codeElement) return;\\n\\n    // support group with tailwindcss\\n    codeBlock.classList.add('group');\\n\\n    // 获取 code 语言类型\\n    const fileType = codeElement.className.match(/language-(\\\\w+)/)?.[1] || '';\\n\\n    classNames =\\n      'opacity-0 scale-0 group-hover:opacity-100 group-hover:scale-100 copy-button delay-200 float-right hover:bg-gray-200 transition-all duration-800 ease-in-out p-2';\\n\\n    // 添加 copybutton\\n    const copyButton = $tw.utils.domMaker('button', {\\n      text: fileType ? `${fileType}` : 'copy',\\n      class: fileType ? classNames : classNames + ' -m-4',\\n    });\\n\\n    const notify = () => {\\n      Swal.fire({\\n        title: `Copied to clipboard`,\\n        icon: 'success',\\n        toast: true,\\n        showCancelButton: false,\\n        showConfirmButton: false,\\n        timer: 1500,\\n        position: 'top-end',\\n      });\\n    };\\n\\n    copyButton.addEventListener('click', () => {\\n      // TODO: add click sound\\n      // copy to clipboard\\n\\n      // IOS 并不支持navigator, 目前不打断写兼容代码\\n      navigator?.clipboard\\n        ?.writeText(codeElement.textContent)\\n        .then(() => {\\n          if (typeof Swal?.fire === 'function') {\\n            notify();\\n          } else {\\n            copyButton.textContent = '✅ Copied!';\\n            setTimeout(() => {\\n              copyButton.textContent = fileType ? `${fileType} 📋` : '📋';\\n            }, 1000);\\n          }\\n        })\\n        .catch((err) => {\\n          console.log(err);\\n        });\\n    });\\n\\n    codeElement?.parentNode?.insertBefore(copyButton, codeElement);\\n  });\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-copy-code/copycode-startup.js\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/copycode-startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-copy-code/copycode-startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\ncopyButton module\\n\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  'use strict';\\n\\n  exports.name = 'copyButton-startup-hook';\\n  exports.platforms = ['browser'];\\n  exports.after = ['startup'];\\n  exports.synchronous = true;\\n  exports.startup = () => {\\n    const addCopyButton = require('$:/plugins/oeyoews/neotw-copy-code/add-copybutton.js');\\n    $tw.rootWidget.addEventListener('om-copy-code', () => {\\n      addCopyButton();\\n    });\\n  };\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/neotw-copy-code/icon\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/icon\",\"text\":\"<svg width=\\\"22pt\\\" height=\\\"22pt\\\" class=\\\"\\\" viewBox=\\\"0 0 24 24\\\"><g fill=\\\"none\\\" fill-rule=\\\"evenodd\\\"><path fill=\\\"currentColor\\\" fill-rule=\\\"nonzero\\\" d=\\\"M10,4.5 C10,4.77614237 9.77614237,5 9.5,5 C9.22385763,5 9,4.77614237 9,4.5 C9,3.67157288 9.67157288,3 10.5,3 L13.5,3 C14.3284271,3 15,3.67157288 15,4.5 C15,4.77614237 14.7761424,5 14.5,5 C14.2238576,5 14,4.77614237 14,4.5 C14,4.22385763 13.7761424,4 13.5,4 L10.5,4 C10.2238576,4 10,4.22385763 10,4.5 Z M7.5,4 C7.77614237,4 8,4.22385763 8,4.5 C8,4.77614237 7.77614237,5 7.5,5 C6.67157288,5 6,5.67157288 6,6.5 L6,18.5 C6,19.3284271 6.67157288,20 7.5,20 L16.5,20 C17.3284271,20 18,19.3284271 18,18.5 L18,6.5 C18,5.67157288 17.3284271,5 16.5,5 C16.2238576,5 16,4.77614237 16,4.5 C16,4.22385763 16.2238576,4 16.5,4 C17.8807119,4 19,5.11928813 19,6.5 L19,18.5 C19,19.8807119 17.8807119,21 16.5,21 L7.5,21 C6.11928813,21 5,19.8807119 5,18.5 L5,6.5 C5,5.11928813 6.11928813,4 7.5,4 Z\\\"/><path fill=\\\"#000\\\" fill-rule=\\\"nonzero\\\" d=\\\"M8.5 10C8.22385763 10 8 9.77614237 8 9.5 8 9.22385763 8.22385763 9 8.5 9L15.5 9C15.7761424 9 16 9.22385763 16 9.5 16 9.77614237 15.7761424 10 15.5 10L8.5 10zM8.5 13C8.22385763 13 8 12.7761424 8 12.5 8 12.2238576 8.22385763 12 8.5 12L15.5 12C15.7761424 12 16 12.2238576 16 12.5 16 12.7761424 15.7761424 13 15.5 13L8.5 13zM8.5 16C8.22385763 16 8 15.7761424 8 15.5 8 15.2238576 8.22385763 15 8.5 15L13.5 15C13.7761424 15 14 15.2238576 14 15.5 14 15.7761424 13.7761424 16 13.5 16L8.5 16z\\\"/></g></svg>\\n\",\"type\":\"text/vnd.tiddlywiki\"},\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\",\"caption\":\"neotw-copy-code Widget\",\"description\":\"Neotw Copy Code Widget\",\"tags\":\"$:/tags/TextEditor/Snippet\"},\"$:/plugins/oeyoews/neotw-copy-code/ui\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/ui\",\"tags\":\"$:/tags/PageControls\",\"list-before\":\"\",\"description\":\"copy code button\",\"caption\":\"Copy Button\",\"text\":\"\\\\whitespace trim\\n<$button message=\\\"om-copy-code\\\" tooltip=\\\"Copy Code\\\" aria-label=\\\"copy\\\" class=<<tv-config-toolbar-class>>>\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n<$text text=\\\"Copy\\\"/>\\n</span>\\n</$list>\\n</$button>\\n\"}}}"}